services:
  # CloudGather | 媒体文件同步工具
  cloudgather:
    image: moyuemoyun/cloudgather:beta
    container_name: cloudgather
    
    volumes:
      # 配置文件持久化（必需）
      - '/vol1/1000/appdata/cloudgather:/app/config'
      - /vol1/1000/appdata/cloudgather/logs:/app/logs
      - '/vol1/1000/data:/data'
      - '/vol02/1000-0-dfac5347/测试:/测试'
      # 挂载源目录和目标目录（根据实际需求修改路径）
      # 示例：群晖 NAS 路径格式
      # - '/volume1/media:/media'
      # - '/volume1/backup:/backup'
      # 示例：普通 Linux 路径格式
      # - '/mnt/source:/source'
      # - '/mnt/target:/target'
    
    ports:
      - '3602:8080'
    
    environment:
      - TZ=Asia/Shanghai  # 时区设置
      - IS_DOCKER=true    # Docker 模式标识
      - PUID=1000         # 运行用户 ID（根据实际情况修改）
      - PGID=1001         # 运行用户组 ID（根据实际情况修改）
      - UMASK=022         # 文件创建掩码（根据实际情况修改）
      # 日志策略配置
      - LOG_LEVEL=INFO           # 文件日志级别 (DEBUG, INFO, WARNING, ERROR)
      - CONSOLE_LEVEL=INFO       # 控制台日志级别 (DEBUG, INFO, WARNING, ERROR)
      - LOG_SAVE_DAYS=7          # 日志保留天数，超过此天数的日志将被自动清理
    
    restart: always
    network_mode: bridge
    
    # 健康检查
    healthcheck:
      test: ['CMD', 'python', '-c', 'import urllib.request; urllib.request.urlopen("http://localhost:8080/api/status")']
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 10s